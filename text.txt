・発表手順

・研究の概要

私は一型糖尿病患者の血糖値を安全に一定の範囲内に制御することを目的とした研究をしています。

一型糖尿病とは、体内インスリン産生が停止することによって発症します。患者は慢性的に高血糖となるため外部よりインスリンを投与する必要があります。
インスリンの投与量は患者自身の判断で決定されるためリスクを伴います。

そこで開発が進められているのが人工すい臓です。
人工すい臓は以下の図で説明すると、meal modelを患者とすると、患者からセンサーによって血糖値を測定し、コントローラ(制御アルゴリズム)によって投与量を決定し、インスリンポンプによって自動投与するシステムのことです。コントローラ(制御アルゴリズム)としてはモデル予測制御が主に考えられています。モデル予測制御とは予測モデルによって未来の応答を予測し、適切な入力を計算するアルゴリズムです。

適切な入力値を決定するには、適切な予測モデルが必要です。従来のモデルでは血糖値応答の非線形性を再現できていません。そこで新しくグルコース-インスリン動態切り換えモデルが提案されました。

この予測モデルを用いてモデル予測制御を行うにはモデルの現在の状態を知る必要があります。しかし、一般にすべての状態を観測することはできません。

そこで本研究では
一型糖尿病患者の制御モデルとして新たに提案されたグルコース-インスリン動態切り換えモデルに対して状態推定器を構築していきます。


・モデルの特徴

次に
まず本研究で使用する仮想患者モデルについて説明します。
仮想患者としては UVA/Padovaモデル を使用します。このモデルはアメリカFDAによって動物実験の代替として承認されており、人工膵臓の制御アルゴリズムの評価に広く用いられているシミュレーションモデルです。本研究ではこのモデルを、実際の患者に相当するものとして利用します。

次に、本研究で利用するグルコース–インスリン動態切り換えモデル SSOGMM について説明します。
SSOGMMは、既存の SOGMMの消化管吸収式に、線形切り換えシステムを追加した拡張モデルです。

先に、数でUVA/Padovaモデルに対してパラメータ推定を行った場合の SOGMM と SSOGMM の応答比較を示します。その次にSSOGMMのパラメータ推定法について簡単に紹介します。
黒線がUVA/Padovaモデル、赤線がSOGMM、青線がSSOGMMです。
SOGMMは一部の血糖変動を再現できていないのに対して、SSOGMMは切り換えによる非線形表現が加わることで UVA/Padovaモデルの応答をより精密に再現できていることが分かります。

続いて、SSOGMMのパラメータ推定について簡単に説明します。
SSOGMMの状態方程式は、代謝パラメータを含む条件式によってモードが切り替わる構造になっています。一般に、条件式に推定対象のパラメータが含まれていると、最適化問題が複雑になり、直接解くことが困難になります。

そこで、SSOGMMでは モード推定器 が提案されています。
これは、あらかじめ血糖値データから切り換えのタイミング（モード列）を推定し、そのモード列を固定してから通常の手法でパラメータ推定を行うというものです。この方法により、切り換え条件を含む複雑な最適化を回避し、安定してパラメータ推定が可能になります。


次に今回構築する状態推定器について説明します。
状態推定器としてはオブザーバと拡張カルマンフィルタの２種類を構築し比較を行います。
また切り替えシステムを含む消化管サブモデルについては、食事データと切り換えタイミングがわかっていることとして、その出力Ｒａを既知の外乱として入力します。

--------------------------------------------------------
次に、本研究で構築する状態推定器について説明します。
今回の目的は、切り換え型モデル SSOGMM に対して、どのような推定手法がより安定して内部状態を推定できるかを評価することです。

本研究では、2種類の状態推定手法を構築し比較を行います。
1つは、モデルの構造を利用して設計する オブザーバ（観測器）、
もう1つは、非線形システムに対して広く用いられる 拡張カルマンフィルタ（EKF） です。
これらを同一条件で適用し、推定誤差や収束特性を比較することで、切り換えモデルに適した推定方法を検討します。

また、SSOGMM のうち 切り換えシステムを含む消化管サブモデル については、食事データと切り換えタイミングが既知であると仮定します。これにより、消化管サブモデルから出力される Ra（糖吸収速度） を既知の外乱入力として扱います。
これによって、状態推定器は主に血糖–インスリン動態部分に集中して推定を行うことができ、推定結果の比較がより明確になります。
--------------------------------------------------------


・数値実験


ここから構築した２つの状態推定器の結果を比較します。

まず、血糖値の推定精度については、UVA/Padovaモデルを真値として RMSE（Root Mean Square Error） を計算し、オブザーバと拡張カルマンフィルタ（EKF）を比較しました。
その結果、両手法とも血糖値を良好に推定できており、精度としては EKFがわずかに優れていることが確認できました。

一方で、SSOGMMの内部状態については、UVAモデルと物理的に対応する状態が存在しないため、同様にRMSEを直接計算することはできません。そこでUVAモデルと同じ入力条件でのSSOGMMのシミュレーションを同時に示し、推定器が求めた状態との差異を確認しました。れにより、血糖値データのみを入力として、モデル内部の状態をどの程度再現できているかを確認します。そうすると、両推定器とも内部状態を概ね再現できている一方で、EKFのほうが同じ初期状態で始めているのにかかわらず、オブザーバより早く収束していることが確認できた。


・結果





追加すること

棒グラフ
グラフの大きさ


説明について

モード推定器についてもう少し説明する．
スイッチングの難しさとそれによって楽になったこと
q1q2がわかるから簡単に状態推定器を組むことができる．みたいな

今後の展望について簡単に　mpcを考えていきたい




